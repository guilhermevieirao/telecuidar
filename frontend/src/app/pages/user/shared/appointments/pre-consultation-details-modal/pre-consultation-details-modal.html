@if (isOpen) {
  <div class="modal-overlay" (click)="onClose()">
    <div class="modal-container" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>Detalhes da Pré-consulta</h2>
        <button class="close-btn" (click)="onClose()">
          <app-icon name="close" [size]="24" />
        </button>
      </div>

      <div class="modal-content" *ngIf="preConsultation">
        <div class="section">
          <h3>Informações Pessoais</h3>
          <div class="grid">
            <div class="item">
              <span class="label">Nome Completo:</span>
              <span class="value">{{ preConsultation.personalInfo.fullName }}</span>
            </div>
            <div class="item">
              <span class="label">Data de Nascimento:</span>
              <span class="value">{{ preConsultation.personalInfo.birthDate | date:'dd/MM/yyyy' }}</span>
            </div>
            <div class="item">
              <span class="label">Peso:</span>
              <span class="value">{{ preConsultation.personalInfo.weight }} kg</span>
            </div>
            <div class="item">
              <span class="label">Altura:</span>
              <span class="value">{{ preConsultation.personalInfo.height }} cm</span>
            </div>
          </div>
        </div>

        <div class="section">
          <h3>Histórico Médico</h3>
          <div class="grid">
            <div class="item full-width" *ngIf="preConsultation.medicalHistory.chronicConditions">
              <span class="label">Doenças Crônicas:</span>
              <span class="value">{{ preConsultation.medicalHistory.chronicConditions }}</span>
            </div>
            <div class="item full-width" *ngIf="preConsultation.medicalHistory.medications">
              <span class="label">Medicamentos:</span>
              <span class="value">{{ preConsultation.medicalHistory.medications }}</span>
            </div>
            <div class="item" *ngIf="preConsultation.medicalHistory.allergies">
              <span class="label">Alergias:</span>
              <span class="value">{{ preConsultation.medicalHistory.allergies }}</span>
            </div>
            <div class="item" *ngIf="preConsultation.medicalHistory.surgeries">
              <span class="label">Cirurgias:</span>
              <span class="value">{{ preConsultation.medicalHistory.surgeries }}</span>
            </div>
            <div class="item full-width" *ngIf="preConsultation.medicalHistory.generalObservations">
              <span class="label">Observações:</span>
              <span class="value">{{ preConsultation.medicalHistory.generalObservations }}</span>
            </div>
          </div>
        </div>

        <div class="section">
          <h3>Hábitos de Vida</h3>
          <div class="grid">
            <div class="item">
              <span class="label">Fumante:</span>
              <span class="value">{{ preConsultation.lifestyleHabits.smoker | titlecase }}</span>
            </div>
            <div class="item">
              <span class="label">Álcool:</span>
              <span class="value">{{ preConsultation.lifestyleHabits.alcoholConsumption | titlecase }}</span>
            </div>
            <div class="item">
              <span class="label">Atividade Física:</span>
              <span class="value">{{ preConsultation.lifestyleHabits.physicalActivity | titlecase }}</span>
            </div>
            <div class="item full-width" *ngIf="preConsultation.lifestyleHabits.generalObservations">
              <span class="label">Observações:</span>
              <span class="value">{{ preConsultation.lifestyleHabits.generalObservations }}</span>
            </div>
          </div>
        </div>

        <div class="section">
          <h3>Sinais Vitais</h3>
          <div class="grid">
            <div class="item" *ngIf="preConsultation.vitalSigns.bloodPressure">
              <span class="label">Pressão Arterial:</span>
              <span class="value">{{ preConsultation.vitalSigns.bloodPressure }} mmHg</span>
            </div>
            <div class="item" *ngIf="preConsultation.vitalSigns.heartRate">
              <span class="label">Batimentos:</span>
              <span class="value">{{ preConsultation.vitalSigns.heartRate }} bpm</span>
            </div>
            <div class="item" *ngIf="preConsultation.vitalSigns.temperature">
              <span class="label">Temperatura:</span>
              <span class="value">{{ preConsultation.vitalSigns.temperature }} °C</span>
            </div>
            <div class="item" *ngIf="preConsultation.vitalSigns.oxygenSaturation">
              <span class="label">Saturação O2:</span>
              <span class="value">{{ preConsultation.vitalSigns.oxygenSaturation }}%</span>
            </div>
            <div class="item full-width" *ngIf="preConsultation.vitalSigns.generalObservations">
              <span class="label">Observações:</span>
              <span class="value">{{ preConsultation.vitalSigns.generalObservations }}</span>
            </div>
          </div>
        </div>

        <div class="section">
          <h3>Sintomas Atuais</h3>
          <div class="grid">
            <div class="item full-width">
              <span class="label">Sintomas Principais:</span>
              <span class="value">{{ preConsultation.currentSymptoms.mainSymptoms }}</span>
            </div>
            <div class="item">
              <span class="label">Início:</span>
              <span class="value">{{ preConsultation.currentSymptoms.symptomOnset }}</span>
            </div>
            <div class="item" *ngIf="preConsultation.currentSymptoms.painIntensity !== null">
              <span class="label">Intensidade da Dor:</span>
              <span class="value">{{ preConsultation.currentSymptoms.painIntensity }}/10</span>
            </div>
            <div class="item full-width" *ngIf="preConsultation.currentSymptoms.generalObservations">
              <span class="label">Descrição Detalhada:</span>
              <span class="value">{{ preConsultation.currentSymptoms.generalObservations }}</span>
            </div>
          </div>
        </div>

        <div class="section" *ngIf="preConsultation.additionalObservations">
          <h3>Observações Adicionais</h3>
          <p>{{ preConsultation.additionalObservations }}</p>
        </div>
      </div>

      <div class="modal-footer">
        <app-button variant="primary" (click)="onClose()">Fechar</app-button>
      </div>
    </div>
  </div>
}
